{"version":3,"sources":["Components/Scoreboard/Scoreboard.js","Components/Card/Card.js","Components/App/App.js","index.js"],"names":["Scoreboard","props","className","score","best","hasWon","Card","onClick","draggable","src","img","alt","getRandomNumber","min","max","Math","ceil","floor","random","shuffleArray","arr","i","length","firstIndex","secondIndex","temp","getImages","n","a","images","fetch","response","json","newImage","indexOf","image","push","console","log","App","useState","setScore","setBest","setHasWon","hasRestarted","setHasRestarted","Array","fill","setCardImages","currentCards","setCurrentCards","loading","setLoading","promises","forEach","el","newPromise","Promise","resolve","reject","Image","onload","onerror","all","Error","shuffleUntilOneUnclicked","cards","newCurrent","copy","JSON","parse","stringify","atLeastOneUnclickedCard","slice","filter","card","clicked","resetClickStatus","prev","map","onCardClick","e","id","correspondingCardIndex","findIndex","useEffect","then","newImages","arrayOfCardObjects","uuidv4","cacheImages","savedHighscore","localStorage","highscore","Fragment","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.811ae6cd.chunk.js","sourcesContent":["import React from 'react';\r\n\r\nimport './Scoreboard.css';\r\n\r\nfunction Scoreboard(props) {\r\n  return (\r\n    <div className=\"Scoreboard\">\r\n      <div className=\"Score\">Score: {props.score}</div>\r\n      <div className=\"Best\">Best: {props.best}</div>\r\n      {props.hasWon ? <h1>You won!</h1> : null}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Scoreboard;\r\n","import React from 'react';\r\n\r\nimport './Card.css';\r\n\r\nfunction Card(props) {\r\n  return (\r\n    <div className=\"Card\" onClick={props.onClick}>\r\n      <img draggable=\"false\" className=\"Card__image\" src={props.img} alt=\"\" />\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Card;\r\n","import React, { useState, useEffect } from 'react';\r\n\r\nimport './App.css';\r\n\r\nimport Scoreboard from '../Scoreboard/Scoreboard.js';\r\nimport Card from '../Card/Card.js';\r\n\r\nimport { v4 as uuidv4 } from 'uuid';\r\n\r\nlet getRandomNumber = (min, max) => {\r\n  min = Math.ceil(min);\r\n  max = Math.floor(max);\r\n  return Math.floor(Math.random() * (max - min + 1) + min);\r\n};\r\n\r\nlet shuffleArray = (arr) => {\r\n  for (let i = 0; i < arr.length; ++i) {\r\n    let firstIndex, secondIndex;\r\n    let temp;\r\n\r\n    firstIndex = getRandomNumber(0, arr.length - 1);\r\n    secondIndex = getRandomNumber(0, arr.length - 1);\r\n\r\n    temp = arr[firstIndex];\r\n    arr[firstIndex] = arr[secondIndex];\r\n    arr[secondIndex] = temp;\r\n  }\r\n\r\n  return arr;\r\n};\r\n\r\nlet getImages = async (n) => {\r\n  let images = [];\r\n\r\n  try {\r\n    while (images.length < n) {\r\n      let response = await fetch('https://randomfox.ca/floof/');\r\n      let newImage = await response.json();\r\n\r\n      if (images.indexOf(newImage.image) === -1) {\r\n        images.push(newImage.image);\r\n      }\r\n    }\r\n  } catch (error) {\r\n    console.log(error);\r\n  }\r\n\r\n  return images;\r\n};\r\n\r\nfunction App() {\r\n  const N_OF_CARDS = 10;\r\n  const N_OF_CARDS_SHOWN = 3;\r\n  let [score, setScore] = useState(0);\r\n  let [best, setBest] = useState(0);\r\n  let [hasWon, setHasWon] = useState(false);\r\n  let [hasRestarted, setHasRestarted] = useState(true);\r\n\r\n  // eslint-disable-next-line no-unused-vars\r\n  let [cardImages, setCardImages] = useState(Array(N_OF_CARDS).fill({}));\r\n  let [currentCards, setCurrentCards] = useState(\r\n    Array(N_OF_CARDS_SHOWN).fill({})\r\n  );\r\n  let [loading, setLoading] = useState(true);\r\n\r\n  async function cacheImages(arr) {\r\n    let promises = [];\r\n    arr.forEach((el) => {\r\n      let newPromise = new Promise((resolve, reject) => {\r\n        let img = new Image();\r\n        img.src = el.src;\r\n        img.onload = resolve(true);\r\n        img.onerror = reject('error loading image');\r\n      });\r\n      promises.push(newPromise);\r\n    });\r\n\r\n    try {\r\n      await Promise.all(promises);\r\n    } catch (error) {\r\n      throw new Error(error);\r\n    }\r\n\r\n    setLoading(false);\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (!hasRestarted) return;\r\n    setLoading(true);\r\n\r\n    getImages(N_OF_CARDS).then((newImages) => {\r\n      let arrayOfCardObjects = newImages.map((image) => {\r\n        return {\r\n          id: uuidv4(),\r\n          src: image,\r\n          clicked: false,\r\n        };\r\n      });\r\n      cacheImages(arrayOfCardObjects);\r\n      setCardImages(arrayOfCardObjects);\r\n      shuffleUntilOneUnclicked();\r\n    });\r\n    setHasRestarted(false);\r\n  }, [hasRestarted]);\r\n\r\n  useEffect(() => {\r\n    let savedHighscore = localStorage.highscore;\r\n    if (savedHighscore) {\r\n      setBest(savedHighscore);\r\n    }\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    localStorage.highscore = best;\r\n  }, [best]);\r\n\r\n  function shuffleUntilOneUnclicked() {\r\n    setCardImages((cards) => {\r\n      let copy = JSON.parse(JSON.stringify(cards));\r\n\r\n      let newCurrent;\r\n      let atLeastOneUnclickedCard = false;\r\n      while (!atLeastOneUnclickedCard) {\r\n        shuffleArray(copy);\r\n        newCurrent = copy.slice(0, 3);\r\n\r\n        let filtered = newCurrent.filter((card) => !card.clicked);\r\n        if (filtered.length !== 0) atLeastOneUnclickedCard = true;\r\n      }\r\n\r\n      setCurrentCards(newCurrent);\r\n\r\n      return cards;\r\n    });\r\n  }\r\n\r\n  function resetClickStatus() {\r\n    setCardImages((prev) => {\r\n      return prev.map((el) => {\r\n        let copy = el;\r\n        copy.clicked = false;\r\n\r\n        return copy;\r\n      });\r\n    });\r\n  }\r\n\r\n  function updateScore() {\r\n    setScore((score) => {\r\n      setBest((best) => {\r\n        if (score + 1 > best) return score + 1;\r\n        return best;\r\n      });\r\n      if (score + 1 === N_OF_CARDS) {\r\n        setHasWon(true);\r\n      } else {\r\n        shuffleUntilOneUnclicked();\r\n      }\r\n      return score + 1;\r\n    });\r\n  }\r\n\r\n  function clearScore() {\r\n    setScore(0);\r\n    setBest(0);\r\n  }\r\n\r\n  function gameOver() {\r\n    setScore(0);\r\n    resetClickStatus();\r\n  }\r\n\r\n  function onCardClick(e, id) {\r\n    setCardImages((prev) => {\r\n      let correspondingCardIndex = prev.findIndex((el) => el.id === id);\r\n\r\n      if (prev[correspondingCardIndex].clicked) {\r\n        gameOver();\r\n        return prev;\r\n      }\r\n\r\n      updateScore();\r\n\r\n      let copy = JSON.parse(JSON.stringify(prev));\r\n      copy[correspondingCardIndex].clicked = true;\r\n\r\n      return copy;\r\n    });\r\n  }\r\n\r\n  function displayCards() {\r\n    return (\r\n      <React.Fragment>\r\n        {currentCards.map((card) => {\r\n          return (\r\n            <Card\r\n              key={card.id}\r\n              img={card.src}\r\n              onClick={\r\n                !hasWon\r\n                  ? (e) => {\r\n                      onCardClick(e, card.id);\r\n                    }\r\n                  : null\r\n              }\r\n            />\r\n          );\r\n        })}\r\n      </React.Fragment>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"App\">\r\n      <Scoreboard score={score} best={best} hasWon={hasWon} />\r\n      <div className=\"Game\">\r\n        {loading ? <span className=\"loading\">Loading...</span> : displayCards()}\r\n      </div>\r\n      <div>\r\n        <button\r\n          className=\"Button--reset\"\r\n          onClick={() => {\r\n            clearScore();\r\n            resetClickStatus();\r\n          }}\r\n        >\r\n          Clear score\r\n        </button>\r\n        <button\r\n          className=\"Button--reset\"\r\n          onClick={() => {\r\n            setHasRestarted(true);\r\n            setHasWon(false);\r\n            setScore(0);\r\n          }}\r\n        >\r\n          Restart\r\n        </button>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport App from './Components/App/App';\r\n\r\nReactDOM.render(<App />, document.getElementById('root'));\r\n"],"sourceRoot":""}